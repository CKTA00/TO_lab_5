@startuml

class Main{
    +CreateDefaultBases()
}

class EventGenerator{
    -Vector2: pointFrom
    -Vector2: pointTo
    +GenerateEvent(): Event
}

class EventAlarm{
    -location: Vector2
    -string: eventType
    +Event(Vector2 location)
    +GetLocation(): Vector2
    +IsFalseAlarm(): boolean
    +<i>GetRequiredVehicleAmount(): int
    +<i>GetType(): String
}


class FireAlarm extends EventAlarm{
    +GetRequiredVehicleAmount(): 2
    +GetType(): "PZ"
}

class LocalThreatAlarm extends EventAlarm{
    +GetRequiredVehicleAmount(): 3
    +GetType(): "MZ"
}

interface ISKKMObserver
{
    +Send()
}


class SKKM{
    -bases: BaseContainer
    -List<ISKKMObserver> observersCollection
    +SetStrategy(IDispositionStrategy s): void
    +Alarm(EventAlarm eventAlarm): void
    -Dispose(Vector2 location, in amount): void

    +AddObserver(ISKKMObserver observer): void
    +RemoveObserver(ISKKMObserver observer): void
    +Notify(ISKKMObserver observer): void
    +NotifyAll(): void
}
'Note right: bla bla

class Iterator<Abstract>{
    +<i>HasNext()
    +<i>Next()
}
class Aggregator<Abstract>{
    +<i>Iterate()
}

class BaseContainer extends Aggregator
{
    -list: List<Base>
    +AddBase(): void
    +SubscribeAllVehicles(SKKM center): void
}

class BaseIterator extends Iterator
{

}

class Base extends Aggregator
{

}

class VehicleIterator extends Iterator
{

}

class Vehicle implements ISKKMObserver{

}



interface IDispositionStrategy{
    +<i>ChoseVehicles(SKKM ctx, Vector2 location, int amount): void
}

class NearestBaseStrategy implements IDispositionStrategy {
}

class VehicleState<Abstract>{
    +<i>IsAvailable()</i>
    +<i>EnterState()</i>
    +<i>Update()</i>
}

class Available extends VehicleState{
}

class Disposed extends VehicleState{
}


'Fire ..> "can transition" FalseAlarm
'OtherEvent ..> "can transition" FalseAlarm
EventGenerator "creates" --> EventAlarm
Main "sends events"--> SKKM
Main "requests new event"--> EventGenerator
SKKM o-- "0..5n" ISKKMObserver
SKKM o--> IDispositionStrategy
Main *--"1" BaseContainer
BaseContainer *--"1..n" Base
Base *-- "5" Vehicle
VehicleState -- Vehicle
'Main ... NearestBaseStrategy

Base --> VehicleIterator
BaseContainer --> BaseIterator


'note left of EventManager: Update is called every frame\nand is defined by Unity Engine\nin MonoBehaviour
@enduml